package com.yuecheng.hops.account.repository;


import java.util.Map;

import javax.persistence.Query;

import com.yuecheng.hops.common.utils.BeanUtils;


public class OracleSql
{
    public class CCYAcount
    {
        public static final String PAGE_SQL = "select * from(select a.*,rownum rn from ("
                                              + "select t.* from Merchant t where 1=1 "
                                              + "and (t.merchant_name like '%merchantName%' or 'merchantName' is null) "
                                              + "and (t.merchant_type = 'merchantType' or 'merchantType' is null) "
                                              + "order by t.identity_Id desc) a where rownum <= pageNumber*pageSize)where rn >pageNumber * pageSize - pageSize";

        public static final String All_SQL = "select * from Merchant t where 1=1 "
                                             + "and (t.merchant_name like '%merchantName%' or 'merchantName' is null) "
                                             + "and (t.merchant_type = 'merchantType' or 'merchantType' is null) "
                                             + "order by t.identity_Id desc";
    }

    public class CurrencyAccountBianceHistory
    {

        public static final String queryCurrencyAccountId_Sql = " select * from ("
                                                                + "select ccy.account_id from ccy_account_balance_History_0 ccy "
                                                                + "left join account_type atype on ccy.account_type_id=atype.account_type_id where 1=1  "
                                                                + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss') "
                                                                + "and ((ccy.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null)"
                                                                + " group by ccy.account_id "
                                                                + " union all "
                                                                + "select ccy.account_id from ccy_account_balance_History_1 ccy "
                                                                + "left join account_type atype on ccy.account_type_id=atype.account_type_id where 1=1  "
                                                                + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss') "
                                                                + " and ((ccy.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null)"
                                                                + " group by ccy.account_id "
                                                                + " union all "
                                                                + " select ccy.account_id from ccy_account_balance_History_2 ccy "
                                                                + "left join account_type atype on ccy.account_type_id=atype.account_type_id where 1=1  "
                                                                + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss') "
                                                                + " and ((ccy.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null)"
                                                                + "  group by ccy.account_id "
                                                                + " union all "
                                                                + " select ccy.account_id from ccy_account_balance_History_3 ccy "
                                                                + "left join account_type atype on ccy.account_type_id=atype.account_type_id where 1=1  "
                                                                + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss') "
                                                                + " and ((ccy.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null)"
                                                                + " group by ccy.account_id )";

        public static final String queryAccountReportBos_Sql = " select  ccy.account_id as accountId ,ccy.account_type_id as accountTypeId from (select ccy.account_id ,ccy.account_type_id from ccy_account_balance_History_0 ccy where 1=1"
                                                               + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss') "
                                                               + "group by ccy.account_id,ccy.account_type_id "
                                                               + " union all select ccy.account_id,ccy.account_type_id from ccy_account_balance_History_1 ccy where 1=1  "
                                                               + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss') "
                                                               + "group by ccy.account_id,ccy.account_type_id"
                                                               + " union all select ccy.account_id,ccy.account_type_id from ccy_account_balance_History_2 ccy where 1=1  "
                                                               + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss') "
                                                               + "group by ccy.account_id,ccy.account_type_id "
                                                               + " union all select ccy.account_id,ccy.account_type_id from ccy_account_balance_History_3 ccy where 1=1  "
                                                               + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss') "
                                                               + "group by ccy.account_id,ccy.account_type_id) ccy ";

        public static final String getAccountReportBo_Sql = "select  a.new_available_balance as PERIODBALANCE,b.new_available_balance as PREVIOUSBALANCE,"
                                                            + "a.new_unavailable_banlance as periodUnavailableBalance,b.new_unavailable_banlance as previousUnavailableBalance,"
                                                            + "d.currentExpenditure,c.currentRevenue,e.periodPlusSection,payerccy.periodAddAmtPayer,payeeccy.periodAddAmtPayee from "
                                                            + " (select *from (select * from ("
                                                            + " select ccy.id,ccy.new_available_balance,ccy.account_id,ccy.new_unavailable_banlance from ccy_account_balance_history_0 ccy where 1=1 and "
                                                            + " ccy.account_id=:accountId  and ccy.id=("
                                                            + " select max(ccy0.id) from ccy_account_balance_history_0 ccy0 where ccy0.account_id=:accountId and "
                                                            + " ccy0.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss'))"
                                                            + " union all "
                                                            + " select ccy.id, ccy.new_available_balance,ccy.account_id,ccy.new_unavailable_banlance from ccy_account_balance_history_1 ccy where 1=1 and "
                                                            + " ccy.account_id=:accountId and ccy.id=("
                                                            + "select max(ccy1.id) from ccy_account_balance_history_1 ccy1 where ccy1.account_id=:accountId and "
                                                            + "ccy1.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss'))"
                                                            + " union all "
                                                            + " select ccy.id, ccy.new_available_balance,ccy.account_id,ccy.new_unavailable_banlance from ccy_account_balance_history_2 ccy where 1=1 and "
                                                            + " ccy.account_id=:accountId and ccy.id=("
                                                            + " select max(ccy2.id) from ccy_account_balance_history_2 ccy2 where ccy2.account_id=:accountId and "
                                                            + "ccy2.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss'))"
                                                            + " union all "
                                                            + "select  ccy.id, ccy.new_available_balance,ccy.account_id,ccy.new_unavailable_banlance  from ccy_account_balance_history_3 ccy where 1=1 and "
                                                            + " ccy.account_id=:accountId and ccy.id=( "
                                                            + " select max(ccy3.id) from ccy_account_balance_history_3 ccy3 where ccy3.account_id=:accountId and "
                                                            + " ccy3.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss'))"
                                                            + ")ccy order by  ccy.id desc)ccya where 1=1 and rownum=1) a left join "

                                                            + " (select *from (select * from ("
                                                            + " select ccy.id,ccy.new_available_balance,ccy.account_id,ccy.new_unavailable_banlance from ccy_account_balance_history_0 ccy where 1=1 and "
                                                            + " ccy.account_id=:accountId  and ccy.id=("
                                                            + " select max(ccy0.id) from ccy_account_balance_history_0 ccy0 where ccy0.account_id=:accountId and "
                                                            + " ccy0.create_date <to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss'))"
                                                            + " union all "
                                                            + " select ccy.id, ccy.new_available_balance,ccy.account_id,ccy.new_unavailable_banlance from ccy_account_balance_history_1 ccy where 1=1 and "
                                                            + " ccy.account_id=:accountId and ccy.id=("
                                                            + "select max(ccy1.id) from ccy_account_balance_history_1 ccy1 where ccy1.account_id=:accountId and "
                                                            + "ccy1.create_date <to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss'))"
                                                            + " union all "
                                                            + " select ccy.id, ccy.new_available_balance,ccy.account_id,ccy.new_unavailable_banlance from ccy_account_balance_history_2 ccy where 1=1 and "
                                                            + " ccy.account_id=:accountId and ccy.id=("
                                                            + " select max(ccy2.id) from ccy_account_balance_history_2 ccy2 where ccy2.account_id=:accountId and "
                                                            + "ccy2.create_date <to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss'))"
                                                            + " union all "
                                                            + "select  ccy.id, ccy.new_available_balance,ccy.account_id,ccy.new_unavailable_banlance from ccy_account_balance_history_3 ccy where 1=1 and "
                                                            + " ccy.account_id=:accountId and ccy.id=( "
                                                            + " select max(ccy3.id) from ccy_account_balance_history_3 ccy3 where ccy3.account_id=:accountId and "
                                                            + " ccy3.create_date <to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss'))"
                                                            + ")ccy order by  ccy.id desc)ccyb where 1=1 and rownum=1) b on a.account_id=b.account_id left join "

                                                            // +
                                                            // "(select sum(ccy.change_amount) as periodPlusSection,ccy.account_id from "
                                                            // +
                                                            // " (select ccy.change_amount,ccy.account_id,ccy.id  from ccy_account_balance_history_0 ccy "
                                                            // +
                                                            // "where 1=1   and ccy.account_id=:accountId  and ccy.type=:addType "
                                                            // +
                                                            // " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            // +
                                                            // " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            // + " union "
                                                            // +
                                                            // " select ccy.change_amount,ccy.account_id ,ccy.id from ccy_account_balance_history_1 ccy "
                                                            // +
                                                            // " where 1=1   and ccy.account_id=:accountId  and ccy.type=:addType  "
                                                            // +
                                                            // " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            // +
                                                            // " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            // + " union "
                                                            // +
                                                            // " select ccy.change_amount,ccy.account_id,ccy.id from ccy_account_balance_history_2 ccy "
                                                            // +
                                                            // " where 1=1   and ccy.account_id=:accountId  and ccy.type=:addType  "
                                                            // +
                                                            // " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            // +
                                                            // " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            // + " union "
                                                            // +
                                                            // " select ccy.change_amount,ccy.account_id,ccy.id from ccy_account_balance_history_3 ccy "
                                                            // +
                                                            // " where 1=1   and ccy.account_id=:accountId  and ccy.type=:addType  "
                                                            // +
                                                            // " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            // +
                                                            // " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            // + ")ccy  group by ccy.account_id)  "

                                                            + "(select sum(ccy.change_amount) as currentRevenue,ccy.account_id from ("
                                                            + "select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_0 ccy left join  transaction_history t"
                                                            + " on t.transaction_id= ccy.transaction_id where ccy.account_id=:accountId and t.payee_account_id=:accountId "
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  union all  "
                                                            + "  select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_1 ccy left join  transaction_history t "
                                                            + " on t.transaction_id= ccy.transaction_id where ccy.account_id=:accountId and t.payee_account_id=:accountId "
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  union all  "
                                                            + " select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_2 ccy left join  transaction_history t "
                                                            + " on t.transaction_id= ccy.transaction_id where ccy.account_id=:accountId and t.payee_account_id=:accountId  "
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  union all  "
                                                            + "select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_3 ccy left join  transaction_history t"
                                                            + " on t.transaction_id= ccy.transaction_id where ccy.account_id=:accountId and t.payee_account_id=:accountId "
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  )ccy group by ccy.account_id)c on a.account_id=c.account_id left join"

                                                            + "(select sum(ccy.change_amount) as currentExpenditure,ccy.account_id from ("
                                                            + "select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_0 ccy left join  transaction_history t"
                                                            + " on t.transaction_id= ccy.transaction_id where ccy.account_id=:accountId and (t.payer_account_id=:accountId  or ccy.type=:subType ) "
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  union all  "
                                                            + "  select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_1 ccy left join  transaction_history t "
                                                            + " on t.transaction_id= ccy.transaction_id where ccy.account_id=:accountId and (t.payer_account_id=:accountId or ccy.type=:subType) "
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  union all  "
                                                            + " select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_2 ccy left join  transaction_history t "
                                                            + " on t.transaction_id= ccy.transaction_id where ccy.account_id=:accountId and (t.payer_account_id=:accountId   or ccy.type=:subType) "
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  union all  "
                                                            + "select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_3 ccy left join  transaction_history t"
                                                            + " on t.transaction_id= ccy.transaction_id where ccy.account_id=:accountId and (t.payer_account_id=:accountId   or ccy.type=:subType)"
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  )ccy group by ccy.account_id)d on a.account_id=d.account_id left join "

                                                            + "(select sum(ccy.change_amount)as periodPlusSection,ccy.account_id from ("
                                                            + "select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_0 ccy "
                                                            + " where ccy.account_id=:accountId and ccy.type=:addType "
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  union all  "
                                                            + "  select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_1 ccy "
                                                            + " where ccy.account_id=:accountId and ccy.type=:addType"
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  union all  "
                                                            + " select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_2 ccy "
                                                            + " where ccy.account_id=:accountId and ccy.type=:addType "
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  union all  "
                                                            + "select ccy.transaction_id,ccy.account_id,ccy.change_amount from  ccy_account_balance_history_3 ccy "
                                                            + "  where ccy.account_id=:accountId and ccy.type=:addType"
                                                            + " and ccy.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and ccy.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                            + "  )ccy group by ccy.account_id)e on a.account_id=e.account_id left join "

                                                            + " (select sum(t.amt) as periodAddAmtPayer, t.payer_account_id from transaction_history t "
                                                            + " where t.create_date >= to_date(:beginDate, 'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and t.create_date <= to_date(:endDate, 'yyyy/mm/dd hh24:mi:ss')"
                                                            + " and t.type = '15' group by t.payer_account_id) payerccy on a.account_id=payerccy.payer_account_id left join "

                                                            + " (select sum(t.amt) as periodAddAmtPayee, t.payee_account_id from transaction_history t "
                                                            + " where t.create_date >= to_date(:beginDate, 'yyyy/mm/dd hh24:mi:ss') "
                                                            + " and t.create_date <= to_date(:endDate, 'yyyy/mm/dd hh24:mi:ss')"
                                                            + " and t.type = '15' group by t.payee_account_id) payeeccy on a.account_id=payeeccy.payee_account_id ";

        public static final String queryCurrencyAccountBalanceHistory_Insidesql = "select ccy.accountId,ccy.identityName,to_char(cast(ccy.newAvailableBalance  as decimal(20,4)),'FM999999990.0000') as newAvailableBalance,"
                                                                                  + "to_char(cast(ccy.newUnavailableBanlance  as decimal(20,4)),'FM999999990.0000') as newUnavailableBanlance,"
                                                                                  + "to_char(cast(ccy.newCreditableBanlance  as decimal(20,4)),'FM999999990.0000') as newCreditableBanlance,"
                                                                                  + "to_char(cast(ccy.changeAmount as decimal(20,4)),'FM999999990.0000') as changeAmount,"
                                                                                  + "ccy.type,ccy.createDate,ccy.descStr,ccy.transactionId,ccy.changeType,ccy.accounttypeid,ccy.accountTypeName,ccy.transactionNo,ccy.remark,rownum rn from";

        public static final String queryCurrencyAccountBalanceHistory_Sql = "(select ct.*,atype.account_type_name as accountTypeName,t.transaction_no as transactionNo from  "
                                                                            + "(select c0.id,c0.account_id as accountId,c0.identity_name as identityName,c0.new_available_balance as newAvailableBalance,"
                                                                            + " c0.new_unavailable_banlance as newUnavailableBanlance,c0.new_creditable_banlance as newCreditableBanlance,c0.change_amount as changeAmount,"
                                                                            + " c0.type,to_char(c0.create_date,'YYYY/mm/dd HH24:mi:ss') as createDate,c0.desc_str as descStr,c0.transaction_id as transactionId,c0.type as changeType,"
                                                                            + "c0.account_Type_Id as accountTypeId,c0.remark as remark from ccy_account_balance_history_0 c0 "
                                                                            + "  where 1=1  "
                                                                            + "and ((c0.transaction_Id=:transactionId  and :transactionId is not null) or  :transactionId is null) "
                                                                            + " and ((c0.type=:type and :type is not null) or :type is null) and c0.account_id=:accountId "
                                                                            + "and c0.create_date >=to_date(:beginDate,'yyyy-mm-dd hh24:mi:ss') "
                                                                            + "and c0.create_date <=to_date(:endDate,'yyyy-mm-dd hh24:mi:ss') "
                                                                            + " union all "
                                                                            + "select c1.id,c1.account_id as accountId,c1.identity_name as identityName,c1.new_available_balance as newAvailableBalance,c1.new_unavailable_banlance as newUnavailableBanlance,"
                                                                            + "c1.new_creditable_banlance as newCreditableBanlance,c1.change_amount as changeAmount, c1.type,to_char(c1.create_date,'YYYY/mm/dd HH24:mi:ss') as createDate,c1.desc_str as descStr,"
                                                                            + "c1.transaction_id as transactionId,c1.type as changeType,c1.account_Type_Id as accountTypeId,c1.remark as remark from ccy_account_balance_history_1 c1 "
                                                                            + "  where  1=1 "
                                                                            + "and ((c1.transaction_Id=:transactionId  and :transactionId is not null) or  :transactionId is null) "
                                                                            + " and ((c1.type=:type and :type is not null) or :type is null) and c1.account_id=:accountId "
                                                                            + "and c1.create_date >=to_date(:beginDate,'yyyy-mm-dd hh24:mi:ss') and c1.create_date <=to_date(:endDate,'yyyy-mm-dd hh24:mi:ss')"
                                                                            + " union all "
                                                                            + "select c2.id,c2.account_id as accountId,c2.identity_name as identityName,c2.new_available_balance as newAvailableBalance,c2.new_unavailable_banlance as newUnavailableBanlance,"
                                                                            + "c2.new_creditable_banlance as newCreditableBanlance,c2.change_amount as changeAmount, c2.type,to_char(c2.create_date,'YYYY/mm/dd HH24:mi:ss') as createDate,c2.desc_str as descStr,"
                                                                            + "c2.transaction_id as transactionId,c2.type as changeType,c2.account_Type_Id as accountTypeId,c2.remark as remark from ccy_account_balance_history_2 c2 "
                                                                            + "  where  1=1 "
                                                                            + " and ((c2.transaction_Id=:transactionId  and :transactionId is not null) or  :transactionId is null) "
                                                                            + "  and ((c2.type=:type and :type is not null) or :type is null) and c2.account_id=:accountId"
                                                                            + " and c2.create_date >=to_date(:beginDate,'yyyy-mm-dd hh24:mi:ss') and c2.create_date <=to_date(:endDate,'yyyy-mm-dd hh24:mi:ss')"
                                                                            + " union all "
                                                                            + "select c3.id,c3.account_id as accountId,c3.identity_name as identityName,c3.new_available_balance as newAvailableBalance,c3.new_unavailable_banlance as newUnavailableBanlance,"
                                                                            + "c3.new_creditable_banlance as newCreditableBanlance,c3.change_amount as changeAmount,c3.type,to_char(c3.create_date,'YYYY/mm/dd HH24:mi:ss') as createDate,c3.desc_str as descStr,"
                                                                            + "c3.transaction_id as transactionId,c3.type as changeType,c3.account_Type_Id as accountTypeId,c3.remark as remark from ccy_account_balance_history_3 c3 "
                                                                            + " where  1=1 "
                                                                            + "and ((c3.transaction_Id=:transactionId  and :transactionId is not null) or  :transactionId is null) "
                                                                            + " and ((c3.type=:type and :type is not null) or :type is null) and c3.account_id=:accountId "
                                                                            + " and c3.create_date >=to_date(:beginDate,'yyyy-mm-dd hh24:mi:ss')"
                                                                            + " and c3.create_date <=to_date(:endDate,'yyyy-mm-dd hh24:mi:ss') "
                                                                            + ") ct left join transaction_history t on ct.transactionId = t.transaction_id left join account_type atype on "
                                                                            + "ct.accountTypeId=atype.account_type_id where 1=1 "
                                                                            + " and ((t.transaction_no=:transactionNo and :transactionNo is not null) or :transactionNo is null) "
                                                                            + " order by ct.createDate desc , ct.id desc "
                                                                            + " ) ccy where 1=1  and  ((rownum<=:rownum and :rownum is not null) or :rownum is null) ";

        public static final String queryAccountFundsChange_Insidesql = "select ccy.*,rownum rn from ";

        public static final String queryAccountFundsChange_TransactionSql = "((select  c.account_id as accountId,c.identity_name as identityName,c.new_available_balance as newAvailableBalance,"
                                                                            + "c.new_unavailable_banlance as newUnavailableBanlance,c.new_creditable_banlance as newCreditableBanlance,c.change_amount as changeAmount,"
                                                                            + "t.type,c.create_date as createDate,c.desc_str as descStr, t.transaction_no as transactionNo,t.transaction_id as transactionId,t.type as transactionType from ";

        public static final String queryAccountFundsChange_AccountSql = "((select  c.account_id as accountId,c.identity_name as identityName,c.new_available_balance as newAvailableBalance,"
                                                                        + "c.new_unavailable_banlance as newUnavailableBanlance,c.new_creditable_banlance as newCreditableBanlance,c.change_amount as changeAmount,"
                                                                        + "c.type,c.create_date as createDate,c.desc_str as descStr, t.transaction_no as transactionNo,t.transaction_id as transactionId,t.type as transactionType from ";

        public static final String QUERYACCOUNTFUNDSCHANGE_SQL = "  select th.*, rownum rn                                                        "
                                                                 + "  from (select *                                                              "
                                                                 + "  from (select c.account_id as accountId,                                     "
                                                                 + "               t.type,                                                        "
                                                                 + "               c.new_available_balance as newAvailableBalance,                "
                                                                 + "               t.amt as CHANGEAMOUNT,                                         "
                                                                 + "               to_char(t.create_date, 'YYYY/mm/dd HH24:mi:ss') as createDate  "
                                                                 + "          from (select c.account_id,                                          "
                                                                 + "                       c.new_available_balance,                               "
                                                                 + "                       c.transaction_id                                       "
                                                                 + "                  from ccy_account_balance_history_0 c                        "
                                                                 + "                 where c.account_id = :accountId                              "
                                                                 + "                   and c.create_date >=                                       "
                                                                 + "                       to_date(:beginDate, 'yyyy-mm-dd HH24:mi:ss')           "
                                                                 + "                   and c.create_date <=                                       "
                                                                 + "                       to_date(:endDate2, 'yyyy-mm-dd HH24:mi:ss')             "
                                                                 + "                union all                                                     "
                                                                 + "                select c1.account_id,                                         "
                                                                 + "                       c1.new_available_balance,                              "
                                                                 + "                       c1.transaction_id                                      "
                                                                 + "                  from ccy_account_balance_history_1 c1                       "
                                                                 + "                 where c1.account_id = :accountId                             "
                                                                 + "                   and c1.create_date >=                                      "
                                                                 + "                       to_date(:beginDate, 'yyyy-mm-dd HH24:mi:ss')           "
                                                                 + "                   and c1.create_date <=                                      "
                                                                 + "                       to_date(:endDate2, 'yyyy-mm-dd HH24:mi:ss')             "
                                                                 + "                union all                                                     "
                                                                 + "                select c2.account_id,                                         "
                                                                 + "                       c2.new_available_balance,                              "
                                                                 + "                       c2.transaction_id                                      "
                                                                 + "                  from ccy_account_balance_history_2 c2                       "
                                                                 + "                 where c2.account_id = :accountId                             "
                                                                 + "                   and c2.create_date >=                                      "
                                                                 + "                       to_date(:beginDate, 'yyyy-mm-dd HH24:mi:ss')           "
                                                                 + "                   and c2.create_date <=                                      "
                                                                 + "                       to_date(:endDate2, 'yyyy-mm-dd HH24:mi:ss')             "
                                                                 + "                union all                                                     "
                                                                 + "                select c3.account_id,                                         "
                                                                 + "                       c3.new_available_balance,                              "
                                                                 + "                       c3.transaction_id                                      "
                                                                 + "                  from ccy_account_balance_history_3 c3                       "
                                                                 + "                 where c3.account_id = :accountId                             "
                                                                 + "                   and c3.create_date >=                                      "
                                                                 + "                       to_date(:beginDate, 'yyyy-mm-dd HH24:mi:ss')           "
                                                                 + "                   and c3.create_date <=                                      "
                                                                 + "                       to_date(:endDate2, 'yyyy-mm-dd HH24:mi:ss')) c,         "
                                                                 + "               transaction_history t                                          "
                                                                 + "         where 1 = 1                                                          "
                                                                 + "           and t.transaction_Id = c.transaction_id                            "
                                                                 + "           and (t.payer_account_id = :accountId or                            "
                                                                 + "               t.payee_account_id = :accountId)                               "
                                                                 + "           and (t.type = :type1 or t.type =:type2)                            "
                                                                 + "           and ((t.type = :transactionType and :transactionType is not null) or :transactionType is null)       "
                                                                 + "           and ((t.transaction_no = :transactionNo and :transactionNo is not null) or :transactionNo is null)       "
                                                                 + "           and t.create_date >=                                               "
                                                                 + "               to_date(:beginDate, 'yyyy-mm-dd HH24:mi:ss')                   "
                                                                 + "           and t.create_date <=                                               "
                                                                 + "               to_date(:endDate, 'yyyy-mm-dd HH24:mi:ss')                     "
                                                                 + "         order by t.create_date desc, t.transaction_id desc)                  "
                                                                 + " where ((rownum <= :rownum and :rownum is not null) or                        "
                                                                 + "       :rownum is null)) th                                                   ";

        public static final String QUERYACCOUNTTRANACTION_SQL_COUNT = " select 1                                                     "
                                                                      + "  from (select c.transaction_id                                      "
                                                                      + "          from ccy_account_balance_history_0 c                       "
                                                                      + "         where c.account_id = :accountId                             "
                                                                      + "           and c.create_date >=                                      "
                                                                      + "               to_date(:beginDate, 'yyyy-mm-dd HH24:mi:ss')          "
                                                                      + "           and c.create_date <=                                      "
                                                                      + "               to_date(:endDate2, 'yyyy-mm-dd HH24:mi:ss')            "
                                                                      + "        union all                                                    "
                                                                      + "        select c1.transaction_id                                     "
                                                                      + "          from ccy_account_balance_history_1 c1                      "
                                                                      + "         where c1.account_id = :accountId                            "
                                                                      + "           and c1.create_date >=                                     "
                                                                      + "               to_date(:beginDate, 'yyyy-mm-dd HH24:mi:ss')          "
                                                                      + "           and c1.create_date <=                                     "
                                                                      + "               to_date(:endDate2, 'yyyy-mm-dd HH24:mi:ss')            "
                                                                      + "        union all                                                    "
                                                                      + "        select c2.transaction_id                                     "
                                                                      + "          from ccy_account_balance_history_2 c2                      "
                                                                      + "         where c2.account_id = :accountId                            "
                                                                      + "           and c2.create_date >=                                     "
                                                                      + "               to_date(:beginDate, 'yyyy-mm-dd HH24:mi:ss')          "
                                                                      + "           and c2.create_date <=                                     "
                                                                      + "               to_date(:endDate2, 'yyyy-mm-dd HH24:mi:ss')            "
                                                                      + "        union all                                                    "
                                                                      + "        select c3.transaction_id                                     "
                                                                      + "          from ccy_account_balance_history_3 c3                      "
                                                                      + "         where c3.account_id = :accountId                            "
                                                                      + "           and c3.create_date >=                                     "
                                                                      + "               to_date(:beginDate, 'yyyy-mm-dd HH24:mi:ss')          "
                                                                      + "           and c3.create_date <=                                     "
                                                                      + "               to_date(:endDate2, 'yyyy-mm-dd HH24:mi:ss')) c,        "
                                                                      + "       transaction_history t                                         "
                                                                      + "   where 1 = 1                                                       "
                                                                      + "   and t.transaction_Id = c.transaction_id                           "
                                                                      + "   and (t.payer_account_id = :accountId or                           "
                                                                      + "       t.payee_account_id = :accountId)                              "
                                                                      + "   and ((t.transaction_no=:transactionNo and :transactionNo is not null) or :transactionNo is null)   "
                                                                      + "   and (t.type = :type1 or t.type = :type2)                          "
                                                                      + "   and ((t.type = :transactionType and :transactionType is not null) or :transactionType is null)       "
                                                                      + "   and t.create_date >= to_date(:beginDate, 'yyyy-mm-dd HH24:mi:ss') "
                                                                      + "   and t.create_date <= to_date(:endDate, 'yyyy-mm-dd HH24:mi:ss')   ";

        public static final String QUERYACCOUNTTRANACTION_SQL_BEGIN = "  select th.*, rownum rn                                                                                                              "
                                                                      + "  from (select th.*,                                                             "
                                                                      + "           p.product_name as productNo,                                        "
                                                                      + "           o.merchant_order_no as merchantOrderNo,                             "
                                                                      + "           o.user_code as userCode,                                            "
                                                                      + "           o.product_face as productFace                                       "
                                                                      + "  from (select c.account_id as accountId,                                      "
                                                                      + "           t.type,                                                             "
                                                                      + "           c.new_available_balance as newAvailableBalance,                     "
                                                                      + "           t.amt as CHANGEAMOUNT,                                              "
                                                                      + "           to_char(t.create_date, 'YYYY/mm/dd HH24:mi:ss') as createDate,      "
                                                                      + "           t.transaction_no as TRANSACTIONNO                                        "
                                                                      + "      from (select c.account_id,                                               "
                                                                      + "                   c.new_available_balance,                                    "
                                                                      + "                   c.transaction_id                                            "
                                                                      + "              from ccy_account_balance_history_0 c                             "
                                                                      + "             where c.account_id = :accountId                                   "
                                                                      + "               and c.create_date >=                                            "
                                                                      + "                   to_date(:beginDate,                                         "
                                                                      + "                           'yyyy-mm-dd HH24:mi:ss')                            "
                                                                      + "               and c.create_date <=                                            "
                                                                      + "                   to_date(:endDate2,                                           "
                                                                      + "                           'yyyy-mm-dd HH24:mi:ss')                            "
                                                                      + "            union all                                                          "
                                                                      + "            select c1.account_id,                                              "
                                                                      + "                   c1.new_available_balance,                                   "
                                                                      + "                   c1.transaction_id                                           "
                                                                      + "              from ccy_account_balance_history_1 c1                            "
                                                                      + "             where c1.account_id = :accountId                                  "
                                                                      + "               and c1.create_date >=                                           "
                                                                      + "                   to_date(:beginDate,                                         "
                                                                      + "                           'yyyy-mm-dd HH24:mi:ss')                            "
                                                                      + "               and c1.create_date <=                                           "
                                                                      + "                   to_date(:endDate2,                                           "
                                                                      + "                           'yyyy-mm-dd HH24:mi:ss')                            "
                                                                      + "            union all                                                          "
                                                                      + "            select c2.account_id,                                              "
                                                                      + "                   c2.new_available_balance,                                   "
                                                                      + "                   c2.transaction_id                                           "
                                                                      + "              from ccy_account_balance_history_2 c2                            "
                                                                      + "             where c2.account_id = :accountId                                  "
                                                                      + "               and c2.create_date >=                                           "
                                                                      + "                   to_date(:beginDate,                                         "
                                                                      + "                           'yyyy-mm-dd HH24:mi:ss')                            "
                                                                      + "               and c2.create_date <=                                           "
                                                                      + "                   to_date(:endDate2,                                           "
                                                                      + "                           'yyyy-mm-dd HH24:mi:ss')                            "
                                                                      + "            union all                                                          "
                                                                      + "            select c3.account_id,                                              "
                                                                      + "                   c3.new_available_balance,                                   "
                                                                      + "                   c3.transaction_id                                           "
                                                                      + "              from ccy_account_balance_history_3 c3                            "
                                                                      + "             where c3.account_id = :accountId                                  "
                                                                      + "               and c3.create_date >=                                           "
                                                                      + "                   to_date(:beginDate,                                         "
                                                                      + "                           'yyyy-mm-dd HH24:mi:ss')                            "
                                                                      + "               and c3.create_date <=                                           "
                                                                      + "                   to_date(:endDate2,                                           "
                                                                      + "                           'yyyy-mm-dd HH24:mi:ss')) c,                        "
                                                                      + "           transaction_history t                                             "
                                                                      + "    where 1 = 1                                                               "
                                                                      + "       and ((t.transaction_no=:transactionNo and :transactionNo is not null) or :transactionNo is null)         "
                                                                      + "       and t.transaction_Id = c.transaction_id                                 "
                                                                      + "       and (t.payer_account_id = :accountId or                                 "
                                                                      + "           t.payee_account_id = :accountId)                                    "
                                                                      + "       and (t.type = :type1 or t.type =:type2)                                         "
                                                                      + "       and ((t.type = :transactionType and :transactionType is not null) or :transactionType is null)       "
                                                                      + "       and t.create_date >=                                                    "
                                                                      + "           to_date(:beginDate, 'yyyy-mm-dd HH24:mi:ss')                        "
                                                                      + "       and t.create_date <=                                                    "
                                                                      + "           to_date(:endDate, 'yyyy-mm-dd HH24:mi:ss')                          "
                                                                      + "     order by t.create_date desc, t.transaction_id desc)th left join           ";

        public static final String QUERYACCOUNTTRANACTION_SQL_END = " where ((rownum<=:rownum and :rownum is not null) or :rownum is null)) th ";
    }

    public class IdentityAccountRole
    {
        public static final String queryCurrencyAccountBySp_Insidesql = "select cyat.accounttypeid,cyat.accounttypename,cyat.identityid,cyat.merchantname,cyat.relation,cyat.accountid,"
                                                                        + "to_char(cast(cyat.availablebalance as decimal(20,4)),'FM999999990.0000') as availablebalance,to_char(cast(cyat.unavailablebanlance as decimal(20,4)),'FM999999990.0000') as unavailablebanlance,to_char(cast(cyat.creditablebanlance as decimal(20,4)),'FM999999990.0000')  as creditablebanlance"
                                                                        + ",cyat.identitysp,cyat.spname,cyat.rmk,rownum rn from ";

        public static final String queryCurrencyAccountBySp_Sql = "(select * from (select  t.account_type_id as accounttypeid,t.account_type_name as accounttypename,m.identity_id as identityid,m.merchant_name as merchantname,"
                                                                  + "i.relation,a.account_id as accountid,a.available_balance as availablebalance,a.unavailable_banlance as unavailablebanlance,"
                                                                  + "a.creditable_banlance as creditablebanlance,sp.identity_id as identitysp,sp.sp_name as spname,a.rmk "
                                                                  + "from account_type t right join identity_account_role i on t.account_type_id=i.account_type left join  "
                                                                  + "merchant m on i.identity_id=m.identity_id  left join sp on i.identity_id=sp.identity_id right join "
                                                                  + "(select * from system_debit_account0 sda0 where 1=1 and ((sda0.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null) )a "
                                                                  + " on i.account_id=a.account_id  where 1=1 and ((t.identity_type=:identityType and :identityType is not null) or :identityType is null)"
                                                                  + "and ((t.type_model=:typeModel and :typeModel is not null) or :typeModel is null)"
                                                                  + " union all "
                                                                  + " select  t.account_type_id as accounttypeid,t.account_type_name as accounttypename,m.identity_id as identityid,m.merchant_name as merchantname,"
                                                                  + "i.relation,a.account_id as accountid,a.available_balance as availablebalance,a.unavailable_banlance as unavailablebanlance,"
                                                                  + "a.creditable_banlance as creditablebanlance,sp.identity_id as identitysp,sp.sp_name as spname,a.rmk from account_type t right join "
                                                                  + " identity_account_role i on t.account_type_id=i.account_type left join  merchant m on i.identity_id=m.identity_id  left join "
                                                                  + "sp on i.identity_id=sp.identity_id right join "
                                                                  + "(select * from system_debit_account1 sda1 where 1=1 and ((sda1.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null)"
                                                                  + " )a on i.account_id=a.account_id  where 1=1 and  ((t.identity_type=:identityType and :identityType is not null) or :identityType is null) "
                                                                  + " and ((t.type_model=:typeModel and :typeModel is not null) or :typeModel is null) "
                                                                  + " union all "
                                                                  + " select  t.account_type_id as accounttypeid,t.account_type_name as accounttypename,m.identity_id as identityid,m.merchant_name as merchantname,"
                                                                  + "i.relation,a.account_id as accountid,a.available_balance as availablebalance,a.unavailable_banlance as unavailablebanlance,"
                                                                  + "a.creditable_banlance as creditablebanlance,sp.identity_id as identitysp,sp.sp_name as spname,a.rmk from account_type t right join "
                                                                  + " identity_account_role i on t.account_type_id=i.account_type left join  merchant m on i.identity_id=m.identity_id  left join "
                                                                  + " sp on i.identity_id=sp.identity_id right join "
                                                                  + " (select * from system_debit_account2 sda2 where 1=1 and  ((sda2.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null))a "
                                                                  + "on i.account_id=a.account_id  where 1=1 and  ((t.identity_type=:identityType and :identityType is not null) or :identityType is null) "
                                                                  + " and ((t.type_model=:typeModel and :typeModel is not null) or :typeModel is null) "
                                                                  + " union all "
                                                                  + " select  t.account_type_id as accounttypeid,t.account_type_name as accounttypename,m.identity_id as identityid,m.merchant_name as merchantname,i.relation,"
                                                                  + " a.account_id as accountid,a.available_balance as availablebalance,a.unavailable_banlance as unavailablebanlance,"
                                                                  + "a.creditable_banlance as creditablebanlance,sp.identity_id as identitysp,sp.sp_name as spname,a.rmk from account_type t right join "
                                                                  + "identity_account_role i on t.account_type_id=i.account_type left join  merchant m on i.identity_id=m.identity_id  left join "
                                                                  + " sp on i.identity_id=sp.identity_id right join (select * from system_debit_account3 sda3 where 1=1 and "
                                                                  + "((sda3.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null))a "
                                                                  + " on i.account_id=a.account_id  where 1=1 and  ((t.identity_type=:identityType and :identityType is not null) or :identityType is null) "
                                                                  + "and ((t.type_model=:typeModel and :typeModel is not null) or :typeModel is null)"
                                                                  + " union all "
                                                                  + "select  t.account_type_id as accounttypeid,t.account_type_name as accounttypename,m.identity_id as identityid,m.merchant_name "
                                                                  + " as merchantname,i.relation,a.account_id as accountid,a.available_balance as availablebalance,a.unavailable_banlance as unavailablebanlance,"
                                                                  + " a.creditable_banlance as creditablebanlance,sp.identity_id as identitysp,sp.sp_name as spname,a.rmk "
                                                                  + " from account_type t right join identity_account_role i on t.account_type_id=i.account_type "
                                                                  + " left join  merchant m on i.identity_id=m.identity_id  left join sp on i.identity_id=sp.identity_id "
                                                                  + " right join (select * from system_debit_account4 sda4 where 1=1 and ((sda4.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null))a "
                                                                  + "on i.account_id=a.account_id  where 1=1 and  ((t.identity_type=:identityType and :identityType is not null) or :identityType is null) and "
                                                                  + "((t.type_model=:typeModel and :typeModel is not null) or :typeModel is null) "
                                                                  + " union all "
                                                                  + "select  t.account_type_id as accounttypeid,t.account_type_name as accounttypename,m.identity_id as identityid,m.merchant_name as merchantname,"
                                                                  + "i.relation,a.account_id as accountid,a.available_balance as availablebalance,a.unavailable_banlance as unavailablebanlance,"
                                                                  + "a.creditable_banlance as creditablebanlance,sp.identity_id as identitysp,sp.sp_name as spname,a.rmk from account_type t right join "
                                                                  + "identity_account_role i on t.account_type_id=i.account_type left join  merchant m on i.identity_id=m.identity_id  left join "
                                                                  + "sp on i.identity_id=sp.identity_id right join (select * from system_debit_account5 sda5 where 1=1 "
                                                                  + "and ((sda5.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null))a "
                                                                  + " on i.account_id=a.account_id  where 1=1 and  ((t.identity_type=:identityType and :identityType is not null) or :identityType is null) "
                                                                  + "and ((t.type_model=:typeModel and :typeModel is not null) or :typeModel is null)"
                                                                  + " union all "
                                                                  + "select  t.account_type_id as accounttypeid,t.account_type_name as accounttypename,m.identity_id as identityid,m.merchant_name as merchantname,"
                                                                  + "i.relation,a.account_id as accountid,a.available_balance as availablebalance,a.unavailable_banlance as unavailablebanlance,"
                                                                  + "a.creditable_banlance as creditablebanlance,sp.identity_id as identitysp,sp.sp_name as spname,a.rmk from account_type t right join "
                                                                  + "identity_account_role i on t.account_type_id=i.account_type left join  merchant m on i.identity_id=m.identity_id  left join "
                                                                  + "sp on i.identity_id=sp.identity_id right join (select * from system_debit_account6 sda6 where 1=1 and ((sda6.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null))a "
                                                                  + "on i.account_id=a.account_id  where 1=1 and  ((t.identity_type=:identityType and :identityType is not null) or :identityType is null) "
                                                                  + "and ((t.type_model=:typeModel and :typeModel is not null) or :typeModel is null) "
                                                                  + " union all "
                                                                  + "select  t.account_type_id as accounttypeid,t.account_type_name as accounttypename,m.identity_id as identityid,m.merchant_name as merchantname,"
                                                                  + "i.relation,a.account_id as accountid,a.available_balance as availablebalance,a.unavailable_banlance as unavailablebanlance,"
                                                                  + "a.creditable_banlance as creditablebanlance,sp.identity_id as identitysp,sp.sp_name as spname,a.rmk from account_type t right join "
                                                                  + "identity_account_role i on t.account_type_id=i.account_type left join  merchant m on i.identity_id=m.identity_id  left join "
                                                                  + "sp on i.identity_id=sp.identity_id right join (select * from system_debit_account7 sda7 where 1=1 and ((sda7.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null))a "
                                                                  + "on i.account_id=a.account_id  where 1=1 and  ((t.identity_type=:identityType and :identityType is not null) or :identityType is null) "
                                                                  + "and ((t.type_model=:typeModel and :typeModel is not null) or :typeModel is null)"
                                                                  + " union all "
                                                                  + "select  t.account_type_id as accounttypeid,t.account_type_name as accounttypename,m.identity_id as identityid,m.merchant_name as merchantname,"
                                                                  + "i.relation,a.account_id as accountid,a.available_balance as availablebalance,a.unavailable_banlance as unavailablebanlance,"
                                                                  + "a.creditable_banlance as creditablebanlance,sp.identity_id as identitysp,sp.sp_name as spname,a.rmk from account_type t right join "
                                                                  + "identity_account_role i on t.account_type_id=i.account_type left join  merchant m on i.identity_id=m.identity_id  left join "
                                                                  + " sp on i.identity_id=sp.identity_id right join (select * from system_debit_account8 sda8 where 1=1 and ((sda8.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null))a "
                                                                  + "on i.account_id=a.account_id  where 1=1 and  ((t.identity_type=:identityType and :identityType is not null) or :identityType is null) "
                                                                  + "and ((t.type_model=:typeModel and :typeModel is not null) or :typeModel is null)"
                                                                  + " union all "
                                                                  + "select  t.account_type_id as accounttypeid,t.account_type_name as accounttypename,m.identity_id as identityid,m.merchant_name as merchantname,"
                                                                  + "i.relation,a.account_id as accountid,a.available_balance as availablebalance,a.unavailable_banlance as unavailablebanlance,"
                                                                  + "a.creditable_banlance as creditablebanlance,sp.identity_id as identitysp,sp.sp_name as spname,a.rmk from account_type t right join "
                                                                  + "identity_account_role i on t.account_type_id=i.account_type left join  merchant m on i.identity_id=m.identity_id  left join "
                                                                  + "sp on i.identity_id=sp.identity_id right join (select * from system_debit_account9 sda9 where 1=1 and ((sda9.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null))a "
                                                                  + "on i.account_id=a.account_id  where 1=1 and  ((t.identity_type=:identityType and :identityType is not null) or :identityType is null) "
                                                                  + "and ((t.type_model=:typeModel and :typeModel is not null) or :typeModel is null)"
                                                                  + " union all "
                                                                  + "select  t.account_type_id as accounttypeid,t.account_type_name as accounttypename,m.identity_id as identityid,m.merchant_name as merchantname,"
                                                                  + "i.relation,a.account_id as accountid,a.available_balance as availablebalance,a.unavailable_banlance as unavailablebanlance,"
                                                                  + "a.creditable_banlance as creditablebanlance,sp.identity_id as identitysp,sp.sp_name as spname,a.rmk from account_type t right join "
                                                                  + "identity_account_role i on t.account_type_id=i.account_type left join  merchant m on i.identity_id=m.identity_id  left join "
                                                                  + "sp on i.identity_id=sp.identity_id right  join (select * from ccy_account ccy where 1=1 and ((ccy.account_type_id=:accountTypeId and :accountTypeId is not null) or :accountTypeId is null))a "
                                                                  + "on i.account_id=a.account_id  where 1=1 and  ((t.identity_type=:identityType and :identityType is not null) or :identityType is null) "
                                                                  + "and ((t.type_model=:typeModel and :typeModel is not null) or :typeModel is null)"
                                                                  + ")cy order by cy.accountid) cyat where 1=1  and ((rownum<=:rownum and :rownum is not null) or :rownum is null) "
                                                                  + " and (((cyat.spName like '%'||:spName||'%' and :spName is not null) or :spName is null) "
                                                                  + "or ((cyat.merchantName like '%'||:merchantName||'%' and :merchantName is not null) or :merchantName is null))"
                                                                  + " and ((cyat.relation=:relation and :relation is not null) or :relation is null) ";

        public static final String queryCurrencyAccountByMerchant_Insidesql = "select  c.*,rownum rn from";

        public static final String queryCurrencyAccountByMerchant_Sql = "(select * from ( select * from merchant_credit_account mc where mc.account_id=any("
                                                                        + "select iar.account_id from identity_account_role iar where 1=1 "
                                                                        + " and ((iar.relation=:relation and :relation is not null) or :relation is null)"
                                                                        + " and ((iar.identity_type=:identityType and :identityType is not null) or :identityType is null) "
                                                                        + " and iar.account_type=:accountTypeId "
                                                                        + " and iar.identity_id=any(select mt.identity_id from merchant mt where 1=1 "
                                                                        + " and ((mt.merchant_type=:merchantType and :merchantType is not null) or :merchantType is null)"
                                                                        + " and ((mt.merchant_name like '%'||:merchantName||'%' and :merchantName is not null) or :merchantName is null) ))"
                                                                        + " union all "
                                                                        + "select * from merchant_debit_account md where md.account_id=any("
                                                                        + "select iar.account_id from identity_account_role iar where 1=1 "
                                                                        + " and ((iar.relation=:relation and :relation is not null) or :relation is null)"
                                                                        + " and ((iar.identity_type=:identityType and :identityType is not null) or :identityType is null) "
                                                                        + " and iar.account_type=:accountTypeId "
                                                                        + " and iar.identity_id=any(select mt.identity_id from merchant mt where 1=1 "
                                                                        + " and ((mt.merchant_type=:merchantType and :merchantType is not null) or :merchantType is null) "
                                                                        + " and ((mt.merchant_name like '%'||:merchantName||'%' and :merchantName is not null) or :merchantName is null) ))"
                                                                        + ")a order by a.account_id )c where 1=1 and ((rownum<=:rownum and :rownum is not null) or :rownum is null)";

    }

    public class TransactionHistory
    {
        public static final String queryTransactionHistoryList_Sql_Count = "select count(*)  from  transaction_history t where 1=1 "
                                                                           // +
                                                                           // " and t.create_date >= :beginDate"
                                                                           // +
                                                                           // " and t.create_date <= :endDate"

                                                                           + " and ((t.transaction_No=:transactionNo and :transactionNo is not null) or :transactionNo is null)  "
                                                                           + " and ((t.transaction_Id=:transactionId and :transactionId is not null) or :transactionId is null)  "
                                                                           + " and  ((t.payer_Identity_Name like '%'||:payerIdentityName||'%' and :payerIdentityName is not null) or :payerIdentityName is null)"
                                                                           + " and  ((t.payee_Identity_Name like '%'||:payeeIdentityName||'%' and :payeeIdentityName is not null) or :payeeIdentityName is null)"
                                                                           + " and  ((t.payer_acc_type_id=:payerAccountTypeId and :payerAccountTypeId is not null) or :payerAccountTypeId is null)"
                                                                           + " and  ((t.payee_acc_type_id=:payeeAccountTypeId and :payeeAccountTypeId is not null) or :payeeAccountTypeId is null)"
                                                                           + " and  ((t.type=:type and :type is not null) or :type is null)"
                                                                           + " and t.create_date >= to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss')"
                                                                           + " and t.create_date <= to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                                           + "";

        public static final String queryTransactionHistoryList_Sql = "select transaction.* from ( select t.transaction_id as transactionId,t.transaction_no as transactionNo,"
                                                                     + "t.payer_account_id as payerAccountId, atype1.type_model as payerTypeModel,t.payee_account_id as payeeAccountId,"
                                                                     + "atype2.type_model as payeeTypeModel,t.desc_str as descStr, to_char(cast(t.amt as decimal(16,4)),'FM999999990.0000') as amt,to_char(t.create_Date,'yyyy-mm-dd HH24:mi:ss') as createDate,"
                                                                     + "t.create_date,t.type as type,t.CREATOR as creator,t.PAYER_IDENTITY_NAME as payerIdentityName,t.PAYEE_IDENTITY_NAME as payeeIdentityName,"
                                                                     + "atype1.account_type_name as payerAccountTypeName,atype2.account_type_name as payeeAccountTypeName, t.payer_acc_type_id,"
                                                                     + "t.payee_acc_type_id,rownum rn from  "
                                                                     + "(select  * from  transaction_history t where 1=1 "

                                                                     + " and ((t.transaction_No=:transactionNo and :transactionNo is not null) or :transactionNo is null)  "
                                                                     + " and ((t.transaction_Id=:transactionId and :transactionId is not null) or :transactionId is null)  "
                                                                     + " and  ((t.payer_Identity_Name like '%'||:payerIdentityName||'%' and :payerIdentityName is not null) or :payerIdentityName is null)"
                                                                     + " and  ((t.payee_Identity_Name like '%'||:payeeIdentityName||'%' and :payeeIdentityName is not null) or :payeeIdentityName is null)"
                                                                     + " and  ((t.payer_acc_type_id=:payerAccountTypeId and :payerAccountTypeId is not null) or :payerAccountTypeId is null)"
                                                                     + " and  ((t.payee_acc_type_id=:payeeAccountTypeId and :payeeAccountTypeId is not null) or :payeeAccountTypeId is null)"
                                                                     + " and  ((t.type=:type and :type is not null) or :type is null)"
                                                                     + " and t.create_date >= to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss')"
                                                                     + " and t.create_date <= to_date(:endDate,'yyyy/mm/dd hh24:mi:ss')"
                                                                     + " order by t.create_date desc) t left join "
                                                                     + " account_type atype1 on t.payer_acc_type_id=atype1.account_type_id left join "
                                                                     + " account_type atype2 on t.payee_acc_type_id=atype2.account_type_id "
                                                                     + " ) transaction where 1=1 "
                                                                     + " and ((rownum <=:rownum and :rownum is not null) or :rownum is null) ";

        public static final String getTransactionHistoryOfAmtSum_Sql = "select sum(amt)as amt from transaction_History t where 1=1 and "
                                                                       + "t.create_date >=to_date(:beginDate,'yyyy/mm/dd hh24:mi:ss')  "
                                                                       + "and t.create_date <=to_date(:endDate,'yyyy/mm/dd hh24:mi:ss') "
                                                                       + " and t.payee_account_id=:accoutId  and t.type=:type  order by t.create_date desc";
    }

    public class CCYAccount
    {
        public static final String getCcyAccountById_Sql = "select * from ccy_account ccy where ccy.account_id=:accountId "
                                                           + " union all "
                                                           + "select * from merchant_credit_account  ccy where ccy.account_id=:accountId "
                                                           + " union all "
                                                           + "select * from merchant_debit_account  ccy where ccy.account_id=:accountId "
                                                           + " union all "
                                                           + "select * from system_debit_account0 ccy where ccy.account_id=:accountId"
                                                           + " union all "
                                                           + "select * from system_debit_account1 ccy where ccy.account_id=:accountId"
                                                           + " union all "
                                                           + "select * from system_debit_account2 ccy where ccy.account_id=:accountId"
                                                           + " union all "
                                                           + "select * from system_debit_account3 ccy where ccy.account_id=:accountId"
                                                           + " union all "
                                                           + "select * from system_debit_account4 ccy where ccy.account_id=:accountId"
                                                           + " union all "
                                                           + "select * from system_debit_account5 ccy where ccy.account_id=:accountId"
                                                           + " union all "
                                                           + "select * from system_debit_account6 ccy where ccy.account_id=:accountId"
                                                           + " union all "
                                                           + "select * from system_debit_account7 ccy where ccy.account_id=:accountId"
                                                           + " union all "
                                                           + "select * from system_debit_account8 ccy where ccy.account_id=:accountId"
                                                           + " union all "
                                                           + "select * from system_debit_account9 ccy where ccy.account_id=:accountId";

        public static final String QUERYCCYACCOUNTID_SQL = "select * from ("
                                                           + "select * from ccy_account ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + "select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) "
                                                           + " union all "
                                                           + "select * from merchant_credit_account ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) union all "
                                                           + " select * from merchant_debit_account ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where  1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) "
                                                           + " union all "
                                                           + " select * from system_debit_account0 ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) "
                                                           + " union all "
                                                           + " select * from system_debit_account1 ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) "
                                                           + " union all "
                                                           + " select * from system_debit_account2 ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) "
                                                           + " union all "
                                                           + " select * from system_debit_account3 ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) "
                                                           + " union all "
                                                           + " select * from system_debit_account4 ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) "
                                                           + " union all "
                                                           + " select * from system_debit_account5 ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) "
                                                           + " union all "
                                                           + " select * from system_debit_account6 ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) "
                                                           + " union all "
                                                           + " select * from system_debit_account7 ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) "
                                                           + " union all "
                                                           + " select * from system_debit_account8 ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id) "
                                                           + " union all "
                                                           + " select * from system_debit_account9 ccy where ccy.account_type_id=:accountTypeId and exists("
                                                           + " select r.account_id from identity_account_role r where 1=1 and  ((r.identity_id=:identityId and :identityId is not null) or :identityId is null) and r.relation=:relation "
                                                           + " and r.account_id=ccy.account_id))";

    }

    public static Query setParameter(Map<String, Object> fields, Query query, int startIndex,
                                     int endIndex)
    {
        for (Map.Entry<String, Object> entry : fields.entrySet())
        {
            query.setParameter(entry.getKey(),
                BeanUtils.isNotNull(entry.getValue()) ? entry.getValue().toString() : "");
        }

        if (endIndex > 0)
        {
            query.setParameter("rownum", endIndex);

            query.setParameter("startIndex", startIndex);
        }
        else
        {
            query.setParameter("rownum", "");
        }
        return query;

    }

}
